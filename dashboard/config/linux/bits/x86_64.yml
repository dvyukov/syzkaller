# Copyright 2020 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

shell:
 # android-5.4.yml has own defconfig.
 - make x86_64_defconfig: [-android]
 - make kvm_guest.config: [-android]

config:
 # Should be faster this way.
 - MCORE2
 - BASE_FULL

 # Moved from legacy config, reason for enabling is unknown.
 - KALLSYMS_ABSOLUTE_PERCPU
 - X86_MSR
 - X86_CPUID
 - X86_5LEVEL: n

 # Should be faster this way.
 - PARAVIRT_SPINLOCKS
 - PARAVIRT_DEBUG

 - PROCESSOR_SELECT
 - CPU_SUP_HYGON: n
 # TODO: disable this.
 - CPU_SUP_CENTAUR
 - CPU_SUP_ZHAOXIN: n

 # Required to boot Debian Wheezy.
 - X86_VSYSCALL_EMULATION

 # Intel network support.
 # TODO: should we switch to virtio instead?
 - ETHERNET
 - NET_VENDOR_INTEL
 - E1000

 - X86_ACPI_CPUFREQ
 - CPU_IDLE_GOV_HALTPOLL
 - X86_INTEL_TSX_MODE_ON
 - INTEL_IDLE
 - LEGACY_VSYSCALL_EMULATE
 - EFI: n

 # TODO: remove these, unclear why/if we need these.
 - MTRR_SANITIZER
 - MTRR_SANITIZER_ENABLE_DEFAULT: 0
 - MTRR_SANITIZER_SPARE_REG_NR_DEFAULT: 1
 - X86_REROUTE_FOR_BROKEN_BOOT_IRQS
 - IRQ_REMAP
 - X86_X2APIC
 - X86_MCE_INJECT
 - MICROCODE_AMD
 - MICROCODE_OLD_INTERFACE

 # TODO: remote this ("lets a virtual machine communicate panic events to the host").
 - PVPANIC

 # TODO: remove this, does not seem to be useful on its own.
 - PAGE_EXTENSION

 # TODO: remove this (intended for manual debugging and is disabled by default).
 - MMIOTRACE
 - TRACE_EVENT_INJECT: [v5.5]
 - PREEMPTIRQ_TRACEPOINTS: [v5.5, optional]
 - PM_TRACE_RTC: [optional]

 # TODO: remote this, we don't test in Xen.
 - XEN
 - XEN_PV
 - XEN_PV_SMP
 - XEN_DOM0
 - XEN_PVHVM
 - XEN_PVHVM_SMP
 - XEN_512GB
 - XEN_SAVE_RESTORE
 - XEN_DEBUG_FS: n
 - XEN_PVH
 - PCI_XEN
 - XEN_PCIDEV_FRONTEND
 - XEN_BLKDEV_FRONTEND
 - XEN_BLKDEV_BACKEND: n
 - XEN_SCSI_FRONTEND: n
 - XEN_NETDEV_FRONTEND
 - XEN_NETDEV_BACKEND
 - INPUT_XEN_KBDDEV_FRONTEND
 - HVC_XEN
 - HVC_XEN_FRONTEND
 - TCG_XEN: n
 - XEN_WDT: n
 - DRM_XEN: n
 - XEN_FBDEV_FRONTEND: [optional]
 - SND_XEN_FRONTEND
 - XEN_BALLOON
 - XEN_BALLOON_MEMORY_HOTPLUG: n
 - XEN_SCRUB_PAGES_DEFAULT
 - XEN_DEV_EVTCHN
 - XEN_BACKEND
 - XENFS
 - XEN_COMPAT_XENFS
 - XEN_SYS_HYPERVISOR
 - XEN_XENBUS_FRONTEND
 - XEN_GNTDEV
 - XEN_GRANT_DEV_ALLOC
 - XEN_GRANT_DMA_ALLOC: n
 - SWIOTLB_XEN
 - XEN_PCIDEV_BACKEND
 - XEN_PVCALLS_FRONTEND
 - XEN_PVCALLS_BACKEND
 - XEN_PRIVCMD
 - XEN_ACPI_PROCESSOR
 - XEN_MCE_LOG
 - XEN_HAVE_PVMMU
 - XEN_AUTO_XLATE
 - XEN_ACPI
 - XEN_SYMS
 - XEN_HAVE_VPMU
 - XEN_FRONT_PGDIR_SHBUF
